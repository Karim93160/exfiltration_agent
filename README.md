# Exfiltration-Agent : *L'outil furtif d'exfiltration de donn√©es pour la Red Team*

## üö® Avertissement - Usage √âthique Uniquement üö®

**Cet outil est d√©velopp√© et mis √† disposition √† des fins strictement p√©dagogiques, de recherche en s√©curit√© offensive, et de tests d'intrusion autoris√©s (Red Team).**

Toute utilisation de Exfiltration-Agent sur des syst√®mes non autoris√©s est strictement ill√©gale et contraire √† l'√©thique de la cybers√©curit√©. Les cr√©ateurs et contributeurs de ce projet d√©clinent toute responsabilit√© en cas d'utilisation abusive ou malveillante.

**Utilisez-le de mani√®re responsable et uniquement dans le cadre l√©gal et √©thique.**

## ‚ú® Vue d'Ensemble du Projet

Exfiltration-Agent est une solution d'ing√©nierie de s√©curit√© offensive con√ßue pour simuler avec pr√©cision les tactiques avanc√©es d'exfiltration de donn√©es. Pens√© pour la furtivit√©, la robustesse et la modularit√©, cet agent permet aux √©quipes de Red Team et aux analystes de s√©curit√© de mettre √† l'√©preuve de mani√®re proactive la r√©silience de leurs infrastructures.

Que votre objectif soit d'√©valuer la d√©tection des fuites de donn√©es, l'efficacit√© des pare-feux, ou la capacit√© de vos syst√®mes √† r√©sister √† des agents discrets, Exfiltration-Agent vous offre un contr√¥le granulaire sur ses op√©rations via une interface web intuitive.

## Pourquoi Exfiltration-Agent ?

- **Simulation R√©aliste** : Reproduisez des sc√©narios complexes d'exfiltration pour √©valuer la capacit√© de votre organisation √† d√©tecter et √† pr√©venir les fuites de donn√©es.
- **Furtivit√© Int√©gr√©e** : Des techniques avanc√©es de masquage de processus, de nettoyage des traces, et d'anti-√©vasion pour des tests discrets et difficiles √† attribuer.
- **Multi-Canal** : Utilisez diverses m√©thodes d'exfiltration, y compris HTTP/HTTPS et le tunneling DNS, pour tester les d√©fenses multicouches et les angles morts.
- **Robustesse Op√©rationnelle** : Ne perdez jamais de donn√©es. L'agent g√®re les √©checs de transmission avec des m√©canismes de r√©-essais intelligents et une persistance locale chiffr√©e.
- **Convivialit√©** : Une interface web moderne et intuitive simplifie la configuration et le contr√¥le, rendant l'outil accessible m√™me sur des environnements contraints comme Termux.
- **Modularit√©** : Son architecture bas√©e sur des modules s√©par√©s facilite l'audit du code, sa modification et l'ajout de nouvelles fonctionnalit√©s.

## üöÄ Fonctionnalit√©s Cl√©s en D√©tail

Exfiltration-Agent est une suite compl√®te de capacit√©s d'exfiltration, chacune con√ßue pour maximiser l'efficacit√© et la discr√©tion.

### üîê Chiffrement AES256

- **Confidentialit√© Assur√©e** : Toutes les donn√©es collect√©es sont chiffr√©es avec l'algorithme AES-256 en mode GCM (Galois/Counter Mode) avant d'√™tre transmises.
- **Int√©grit√© et Authentification** : Le mode GCM garantit non seulement la confidentialit√©, mais aussi l'int√©grit√© et l'authenticit√© des donn√©es, prot√©geant contre toute alt√©ration.
- **Cl√© D√©di√©e** : Une cl√© AES unique est utilis√©e, configurable via l'interface, assurant la s√©curit√© de vos exfiltrations.

### üóúÔ∏è Compression Zlib/Gzip

- **Optimisation de la Bande Passante** : Les donn√©es sont compress√©es avec Zlib ou Gzip avant le chiffrement et l'envoi, r√©duisant ainsi la taille des charges utiles et la consommation de r√©seau.
- **Rapidit√© d'Exfiltration** : Des transferts plus petits se traduisent par des exfiltrations plus rapides et moins de temps pass√© sur le r√©seau, augmentant la furtivit√©.

### üìÅ Scan et Filtrage Avanc√© de Fichiers

- **Recherche R√©cursive** : Scanne en profondeur les r√©pertoires sp√©cifi√©s pour d√©couvrir les fichiers cibl√©s.
- **Filtrage Granulaire** :
  - **Par Extension** : Inclusion (.doc, .txt, .db) et exclusion (.exe, .dll) de types de fichiers sp√©cifiques.
  - **Par Taille** : D√©finition de tailles minimales et maximales pour cibler les fichiers pertinents.
  - **Par Contenu** : Recherche de mots-cl√©s ou de motifs d'expressions r√©guli√®res (regex) sp√©cifiques √† l'int√©rieur des fichiers pour identifier les donn√©es sensibles.

### üíª Profilage Syst√®me (sans psutil)

- **Reconnaissance Approfondie** : Collecte des informations vitales sur l'environnement compromis sans d√©pendances externes complexes.
- **Informations Collect√©es** :
  - Nom d'h√¥te et d√©tails du syst√®me d'exploitation.
  - Informations CPU et m√©moire.
  - Informations sur les partitions de disque.
  - D√©tails des interfaces r√©seau (adresses IP, serveurs DNS).
  - Utilisateurs connect√©s et processus en cours d'ex√©cution.
- **Robustesse** : Utilise des commandes shell natives (df, ip, ps, who, cat /proc/...) pour assurer la compatibilit√© maximale sur des syst√®mes h√©t√©rog√®nes (y compris Termux).

### üß¨ Anti-Debug / Sandbox & √âvasion

- **D√©tection d'Environnements Hostiles** : L'agent tente d'identifier s'il est ex√©cut√© dans un environnement d'analyse, comme un d√©bogueur, une machine virtuelle ou un conteneur.
- **Strat√©gies d'√âvasion** :
  - V√©rification des processus parents suspects.
  - Analyse de l'uptime syst√®me (temps de fonctionnement court = sandbox).
  - V√©rification des ratios d'espace disque.
  - Recherche d'artefacts sp√©cifiques aux VM/conteneurs.
  - V√©rification de ptrace (d√©tection de d√©bogueur sur Linux).
  - Analyse des flags CPU pour les indicateurs de virtualisation.
- **Comportement Adaptatif** : Si un environnement suspect est d√©tect√©, l'agent peut s'arr√™ter discr√®tement ou modifier son comportement pour √©viter d'√™tre analys√©.

### üåê Exfiltration HTTP/HTTPS

- **Canal Principal** : Le moyen le plus courant et souvent le plus efficace pour transf√©rer des donn√©es.
- **Furtivit√© R√©seau** : Utilise la biblioth√®que requests avec des User-Agents al√©atoires et des en-t√™tes HTTP r√©alistes pour masquer le trafic d'exfiltration parmi le trafic web normal.
- **Gestion Robuste** : Inclut la gestion des timeouts, des erreurs de connexion et des r√©ponses HTTP.

### üì° Exfiltration DNS

- **Canal Furtif Avanc√©** : Une m√©thode d'exfiltration souvent sous-estim√©e, car le trafic DNS est rarement inspect√© en profondeur.
- **Tunneling Intelligent** : Les donn√©es binaires (chiffr√©es et compress√©es) sont encod√©es en Base32 ou Hexad√©cimal, puis divis√©es en petits "chunks" envoy√©s comme sous-domaines dans des requ√™tes DNS (Type A).
- **Fiabilit√©** : Inclut des identifiants de transaction et des index de chunk pour permettre au serveur de contr√¥le de r√©assembler les donn√©es correctement.

### üîÑ Rotation/Retry Manager

- **Persistance des Donn√©es** : Si une tentative d'exfiltration √©choue (probl√®me r√©seau, serveur inaccessible), les donn√©es ne sont pas perdues.
- **R√©-essais Intelligents** : Les donn√©es sont mises en file d'attente et des tentatives de r√©-envoi sont effectu√©es avec un backoff exponentiel (d√©lai croissant entre les essais) pour ne pas saturer le r√©seau ou le C2.
- **Journalisation Chiffr√©e Locale** : Les donn√©es qui persistent en file d'attente sont sauvegard√©es dans un fichier local chiffr√©, assurant leur s√©curit√© m√™me sur la machine compromise.

### üïµÔ∏è Stealth Mode

- **Masquage de Processus** : Tente de modifier le nom du processus visible pour se fondre dans les processus syst√®me l√©gitimes.
- **R√©pertoire de Travail Temporaire** : Utilise des chemins √©ph√©m√®res (/tmp ou √©quivalent Termux) pour stocker les fichiers temporaires, √©vitant ainsi de laisser des traces persistantes.
- **Auto-Suppression des Logs et Fichiers** : √Ä la fin de l'op√©ration (sauf si d√©sactiv√© en mode debug), l'agent nettoie activement tous les logs chiffr√©s et les fichiers temporaires qu'il a cr√©√©s.
- **Timestomping** : Alterne les horodatages des fichiers cr√©√©s ou modifi√©s pour masquer l'activit√© r√©cente de l'agent.

### üîÅ Threads/Async Tasks

- **Performance Optimale** : L'agent est con√ßu avec une architecture multi-thread√©e.
- **Op√©rations Simultan√©es** : Le scan de fichiers et le processus d'exfiltration/r√©-essai s'ex√©cutent en parall√®le, maximisant l'efficacit√© et la rapidit√© sans bloquer l'agent.
- **Communication S√©curis√©e** : Utilise des files d'attente (queues) thread-safe pour une communication fiable entre les diff√©rents threads.

### üßä Payload Dropper

- **D√©ploiement Post-Exfiltration** : Permet √† l'agent de t√©l√©charger et de d√©poser un ex√©cutable secondaire (RAT, shell, autre malware simul√©) sur la machine cible apr√®s une exfiltration r√©ussie ou en fonction d'un crit√®re.
- **Flexibilit√©** : Facilite l'extension des op√©rations sur la cible.
- **Rendu Ex√©cutable** : Option pour d√©finir les permissions d'ex√©cution sur le fichier d√©pos√©.

### üìä Logger/Telemetry

- **Audit Furtif** : Toutes les activit√©s de l'agent sont journalis√©es localement dans un fichier d√©di√©.
- **Chiffrement des Logs** : Le fichier de logs est lui-m√™me chiffr√© avec AES256 pour maintenir la discr√©tion.
- **Analyse Post-Op√©rationnelle** : Le panneau de contr√¥le web permet de lire, d√©chiffrer et afficher ces logs, offrant une visibilit√© compl√®te sur le d√©roulement de l'op√©ration.

## üõ†Ô∏è Installation et Utilisation (Guide Complet)

Ce guide est optimis√© pour les environnements Termux (Android).

### Pr√©requis

- Un appareil Android avec Termux install√©.
- Une connexion internet active.
- (Optionnel mais fortement recommand√©) Un compte sur webhook.site pour tester l'exfiltration HTTP/HTTPS facilement, ou un serveur C2 que vous contr√¥lez.

### √âtapes d'Installation Automatis√©es

1. Ouvrez Termux sur votre appareil Android.
2. Clonez le d√©p√¥t GitHub :
   ```bash
   git clone [VOTREURLDUD√âP√îTGITHUB] exfiltration_agent
   ```
   *(N'oubliez pas de remplacer [VOTREURLDUD√âP√îTGITHUB] par l'URL r√©elle de votre d√©p√¥t !)*
3. Lancez le script d'installation tout-en-un :
   ```bash
   cd exfiltration_agent
   chmod +x setuptermux.sh exfagent.py control_panel.py # Assure les permissions d'ex√©cution
   ./setup_termux.sh
   ```
   - Le script installera tous les packages Termux n√©cessaires (Python, clang, build-essential, iproute2, procps, coreutils, etc.) et toutes les d√©pendances Python requises (pycryptodome, requests, dnspython).
   - Il lancera automatiquement le panneau de contr√¥le web en arri√®re-plan (`nohup python -u control_panel.py ... &`). Vous verrez un message `nohup: ignoring input` et le PID du processus.

### Acc√®s et Configuration Initiale via le Panneau de Contr√¥le Web

Le panneau de contr√¥le est votre interface graphique compl√®te pour g√©rer l'agent.

1. **Acc√©dez au Panneau de Contr√¥le** :
   Ouvrez le navigateur web de votre appareil Android et saisissez l'adresse :
   ```
   http://127.0.0.1:8050
   ```
   *(Si le port 8050 est d√©j√† utilis√©, un message d'erreur s'affichera dans le terminal Termux. Vous devrez alors modifier la ligne `port=8050` dans le fichier `control_panel.py` vers un autre port, comme 8051, puis relancer le script.)*

2. **Premi√®re Configuration** :
   - √Ä la premi√®re ouverture (apr√®s la g√©n√©ration par `setup_termux.sh`), l'interface affichera une cl√© AES g√©n√©r√©e automatiquement dans le champ "Cl√© AES".
   - **Action Cruciale** : Dans le champ "Cible d'Exfiltration (URL ou IP:Port)", remplacez l'URL par d√©faut par l'URL unique de votre webhook.site ou l'adresse de votre propre serveur de contr√¥le C2. C'est l√† que l'agent enverra les donn√©es.
   - Tous les autres champs (chemin √† scanner, types de fichiers, etc.) seront pr√©-remplis avec des valeurs par d√©faut intelligentes (`/data/data/com.termux/files/home/storage/shared` est un bon point de d√©part pour le stockage interne d'Android).

3. **Sauvegardez votre Configuration** :
   Une fois que vous avez personnalis√© les options, cliquez sur le bouton "Sauvegarder la Configuration". Cela enregistrera tous les param√®tres que vous avez d√©finis dans le fichier `~/exfiltrationagent/sharedconfig.json`. Ainsi, la prochaine fois que vous ouvrirez le panneau, vos pr√©f√©rences seront automatiquement charg√©es.

### Utilisation Quotidienne de l'Agent via l'Interface Web

Apr√®s la configuration initiale, l'utilisation est tr√®s simple :

1. **Lancez le Panneau de Contr√¥le (si ce n'est pas d√©j√† fait)** :
   Si vous avez ferm√© Termux ou arr√™t√© le panneau, relancez-le depuis le r√©pertoire de l'agent :
   ```bash
   cd ~/exfiltration_agent
   nohup python -u controlpanel.py > controlpanel.log 2>&1 &
   ```
   Puis acc√©dez de nouveau √† `http://127.0.0.1:8050` dans votre navigateur.

2. **Configurez et Lancez l'Agent** :
   - Les champs seront pr√©-remplis avec votre derni√®re configuration sauvegard√©e.
   - Ajustez les param√®tres selon le sc√©nario de test souhait√© (nouvel emplacement de scan, nouveaux mots-cl√©s, changement de m√©thode d'exfiltration, etc.).
   - Cliquez sur le bouton "Lancer l'Agent". L'agent s'ex√©cutera en arri√®re-plan, discr√®tement, et commencera ses op√©rations.

3. **Surveillez l'Activit√© et G√©rez l'Agent** :
   - Cliquez sur "Rafra√Æchir les Logs (chiffr√©s localement)" pour voir l'activit√© de l'agent en temps r√©el dans l'interface (d√©chiffr√©e par le panneau de contr√¥le en utilisant la cl√© AES du champ).
   - Si vous utilisez l'exfiltration HTTPS, consultez votre page webhook.site (ou votre C2) pour v√©rifier la r√©ception des donn√©es exfiltr√©es.
   - Utilisez le bouton "Arr√™ter l'Agent" pour l'arr√™ter proprement. Cela d√©clenchera son m√©canisme de nettoyage (si non d√©sactiv√© en mode debug).

4. **T√©l√©chargez les Logs pour Analyse** :
   - Le bouton "T√©l√©charger les Logs Bruts (chiffr√©s)" vous permet de r√©cup√©rer le fichier `agent_logs.enc`. Ce fichier contient toutes les activit√©s de l'agent, chiffr√©es. Vous pouvez le d√©chiffrer avec la cl√© AES de votre panneau de contr√¥le pour une analyse approfondie hors ligne.

## üìú Structure du Projet (D√©p√¥t GitHub)

```
exfiltration_agent/
‚îú‚îÄ‚îÄ README.md                 # Ce fichier : Documentation compl√®te du projet
‚îú‚îÄ‚îÄ exf_agent.py              # Le script principal de l'agent d'exfiltration
‚îú‚îÄ‚îÄ control_panel.py          # Le script de l'interface web Dash pour le contr√¥le
‚îú‚îÄ‚îÄ modules/                  # R√©pertoire contenant tous les modules internes de l'agent
‚îÇ   ‚îú‚îÄ‚îÄ aes256.py             # Chiffrement AES-256 GCM
‚îÇ   ‚îú‚îÄ‚îÄ anti_evasion.py       # Techniques anti-d√©bogage / sandbox
‚îÇ   ‚îú‚îÄ‚îÄ compression.py        # Compression Zlib/Gzip
‚îÇ   ‚îú‚îÄ‚îÄ config.py             # Gestion des arguments de configuration
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_dns.py   # Exfiltration via tunneling DNS
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_http.py  # Exfiltration via HTTP/HTTPS
‚îÇ   ‚îú‚îÄ‚îÄ file_scanner.py       # Scan et filtrage de fichiers
‚îÇ   ‚îú‚îÄ‚îÄ logger.py             # Journalisation chiffr√©e des activit√©s
‚îÇ   ‚îú‚îÄ‚îÄ payload_dropper.py    # D√©p√¥t de payloads secondaires
‚îÇ   ‚îú‚îÄ‚îÄ retry_manager.py      # Gestion des r√©-essais et persistance
‚îÇ   ‚îú‚îÄ‚îÄ stealth_mode.py       # Techniques de furtivit√© et nettoyage
‚îÇ   ‚îî‚îÄ‚îÄ system_profiler.py    # Profilage syst√®me (sans psutil)
‚îú‚îÄ‚îÄ requirements.txt          # D√©pendances Python externes
‚îú‚îÄ‚îÄ setup_termux.sh           # Script d'installation automatis√©e pour Termux
```

## ü§ù Contributions & Support

Les contributions sont les bienvenues ! Si vous avez des id√©es d'am√©lioration, des rapports de bugs, ou des suggestions, n'h√©sitez pas √† :

- **Ouvrir une Issue** : Pour rapporter un bug ou sugg√©rer une nouvelle fonctionnalit√©.
- **Soumettre une Pull Request** : Pour proposer des modifications ou des ajouts de code.

Votre aide est pr√©cieuse pour faire √©voluer Exfiltration-Agent !

## üõ°Ô∏è Licence

Ce projet est distribu√© sous la licence MIT. Cela signifie que vous √™tes libre d'utiliser, de copier, de modifier, de fusionner, de publier, de distribuer, de sous-licencier et/ou de vendre des copies du Logiciel, sous r√©serve des conditions stipul√©es dans la licence.

**MIT License**
```
