[üá´üá∑ Fran√ßais](https://github.com/karim93160/exfiltration_agent/blob/main/README.md) | [üá¨üáß English](https://github.com/karim93160/exfiltration_agent/blob/main/README_EN.md) | [üá™üá∏ Espa√±ol](https://github.com/karim93160/exfiltration_agent/blob/main/README_ES.md)
Exfiltration-Agent:
La herramienta sigilosa de exfiltraci√≥n de datos para Red Team
üö® Advertencia - Solo para Uso √âtico üö®
Esta herramienta est√° desarrollada y disponible estrictamente con fines educativos, de investigaci√≥n en seguridad ofensiva y de pruebas de penetraci√≥n autorizadas (Red Team).
Cualquier uso de Exfiltration-Agent en sistemas no autorizados es estrictamente ilegal y contrario a la √©tica de la ciberseguridad. Los creadores y colaboradores de este proyecto declinan toda responsabilidad en caso de uso indebido o malintencionado.
√öselo de manera responsable y √∫nicamente dentro del marco legal y √©tico.
‚ú® Descripci√≥n General del Proyecto
Exfiltration-Agent es una soluci√≥n de ingenier√≠a de seguridad ofensiva dise√±ada para simular con precisi√≥n t√°cticas avanzadas de exfiltraci√≥n de datos. Dise√±ado para la sigilo, la robustez y la modularidad, este agente permite a los equipos de Red Team y a los analistas de seguridad probar proactivamente la resiliencia de sus infraestructuras.
Ya sea que su objetivo sea evaluar la detecci√≥n de fugas de datos, la efectividad de los firewalls o la capacidad de sus sistemas para resistir agentes discretos, Exfiltration-Agent le ofrece un control granular sobre sus operaciones a trav√©s de una interfaz web intuitiva.
¬øPor qu√© Exfiltration-Agent?
 * Simulaci√≥n Realista: Reproduzca escenarios complejos de exfiltraci√≥n para evaluar la capacidad de su organizaci√≥n para detectar y prevenir fugas de datos.
 * Sigilo Integrado: T√©cnicas avanzadas de ocultamiento de procesos, limpieza de rastros y anti-evasi√≥n para pruebas discretas y dif√≠ciles de atribuir.
 * Multi-Canal: Utilice diversos m√©todos de exfiltraci√≥n, incluyendo HTTP/HTTPS y tunelizaci√≥n DNS, para probar defensas multicapa y puntos ciegos.
 * Robustez Operacional: Nunca pierda datos. El agente maneja los fallos de transmisi√≥n con mecanismos de reintento inteligentes y persistencia local cifrada.
 * F√°cil de Usar: Una interfaz web moderna e intuitiva simplifica la configuraci√≥n y el control, haciendo que la herramienta sea accesible incluso en entornos restringidos como Termux.
 * Modularidad: Su arquitectura basada en m√≥dulos separados facilita la auditor√≠a del c√≥digo, su modificaci√≥n y la adici√≥n de nuevas funcionalidades.
üöÄ Caracter√≠sticas Clave en Detalle
Exfiltration-Agent es una suite completa de capacidades de exfiltraci√≥n, cada una dise√±ada para maximizar la eficiencia y la discreci√≥n.
üîê Cifrado AES256
 * Confidencialidad Asegurada: Todos los datos recopilados se cifran con el algoritmo AES-256 en modo GCM (Galois/Counter Mode) antes de ser transmitidos.
 * Integridad y Autenticaci√≥n: El modo GCM garantiza no solo la confidencialidad, sino tambi√©n la integridad y autenticidad de los datos, protegiendo contra cualquier alteraci√≥n.
 * Clave Dedicada: Se utiliza una clave AES √∫nica, configurable a trav√©s de la interfaz, asegurando la seguridad de sus exfiltraciones.
üóúÔ∏è Compresi√≥n Zlib/Gzip
 * Optimizaci√≥n del Ancho de Banda: Los datos se comprimen con Zlib o Gzip antes del cifrado y el env√≠o, reduciendo as√≠ el tama√±o de las cargas √∫tiles y el consumo de red.
 * Velocidad de Exfiltraci√≥n: Transferencias m√°s peque√±as se traducen en exfiltraciones m√°s r√°pidas y menos tiempo en la red, aumentando el sigilo.
üìÅ Escaneo y Filtrado Avanzado de Archivos
 * B√∫squeda Recursiva: Escanea en profundidad los directorios especificados para descubrir los archivos objetivo.
 * Filtrado Granular:
   * Por Extensi√≥n: Inclusi√≥n (.doc, .txt, .db) y exclusi√≥n (.exe, .dll) de tipos de archivos espec√≠ficos.
   * Por Tama√±o: Definici√≥n de tama√±os m√≠nimos y m√°ximos para apuntar a los archivos relevantes.
   * Por Contenido: B√∫squeda de palabras clave o patrones de expresiones regulares (regex) espec√≠ficas dentro de los archivos para identificar datos sensibles.
üíª Perfilado del Sistema (sin psutil)
 * Reconocimiento Profundo: Recopila informaci√≥n vital sobre el entorno comprometido sin dependencias externas complejas.
 * Informaci√≥n Recopilada:
   * Nombre de host y detalles del sistema operativo.
   * Informaci√≥n de CPU y memoria.
   * Informaci√≥n sobre las particiones de disco.
   * Detalles de las interfaces de red (direcciones IP, servidores DNS).
   * Usuarios conectados y procesos en ejecuci√≥n.
 * Robustez: Utiliza comandos de shell nativos (df, ip, ps, who, cat /proc/...) para garantizar la m√°xima compatibilidad en sistemas heterog√©neos (incluido Termux).
üß¨ Anti-Debug / Sandbox y Evasi√≥n
 * Detecci√≥n de Entornos Hostiles: El agente intenta identificar si se est√° ejecutando en un entorno de an√°lisis, como un depurador, una m√°quina virtual o un contenedor.
 * Estrategias de Evasi√≥n:
   * Verificaci√≥n de procesos padres sospechosos.
   * An√°lisis del tiempo de actividad del sistema (tiempo de ejecuci√≥n corto = sandbox).
   * Verificaci√≥n de proporciones de espacio en disco.
   * B√∫squeda de artefactos espec√≠ficos de VM/contenedores.
   * Verificaci√≥n de ptrace (detecci√≥n de depurador en Linux).
   * An√°lisis de los flags de CPU para indicadores de virtualizaci√≥n.
 * Comportamiento Adaptativo: Si se detecta un entorno sospechoso, el agente puede detenerse discretamente o modificar su comportamiento para evitar ser analizado.
üåê Exfiltraci√≥n HTTP/HTTPS
 * Canal Principal: La forma m√°s com√∫n y a menudo m√°s efectiva de transferir datos.
 * Sigilo de Red: Utiliza la biblioteca requests con User-Agents aleatorios y encabezados HTTP realistas para enmascarar el tr√°fico de exfiltraci√≥n entre el tr√°fico web normal.
 * Manejo Robusto: Incluye manejo de tiempos de espera, errores de conexi√≥n y respuestas HTTP.
üì° Exfiltraci√≥n DNS
 * Canal Sigiloso Avanzado: Un m√©todo de exfiltraci√≥n a menudo subestimado, ya que el tr√°fico DNS rara vez se inspecciona en profundidad.
 * Tunelizaci√≥n Inteligente: Los datos binarios (cifrados y comprimidos) se codifican en Base32 o Hexadecimal, luego se dividen en peque√±os "chunks" enviados como subdominios en consultas DNS (Tipo A).
 * Fiabilidad: Incluye identificadores de transacci√≥n e √≠ndices de chunk para permitir que el servidor de control reensamble los datos correctamente.
üîÑ Administrador de Rotaci√≥n/Reintento
 * Persistencia de Datos: Si un intento de exfiltraci√≥n falla (problema de red, servidor inaccesible), los datos no se pierden.
 * Reintentos Inteligentes: Los datos se ponen en cola y se realizan intentos de reenv√≠o con una retroceso exponencial (demora creciente entre intentos) para no saturar la red o el C2.
 * Registro Local Cifrado: Los datos que persisten en la cola se guardan en un archivo local cifrado, asegurando su seguridad incluso en la m√°quina comprometida.
üïµÔ∏è Modo Sigiloso
 * Ocultamiento de Procesos: Intenta modificar el nombre del proceso visible para mezclarse con los procesos leg√≠timos del sistema.
 * Directorio de Trabajo Temporal: Utiliza rutas ef√≠meras (/tmp o equivalente en Termux) para almacenar archivos temporales, evitando dejar rastros persistentes.
 * Autoeliminaci√≥n de Registros y Archivos: Al finalizar la operaci√≥n (a menos que se desactive en modo de depuraci√≥n), el agente limpia activamente todos los registros cifrados y los archivos temporales que ha creado.
 * Timestomping: Altera las marcas de tiempo de los archivos creados o modificados para ocultar la actividad reciente del agente.
üîÅ Hilos/Tareas As√≠ncronas
 * Rendimiento √ìptimo: El agente est√° dise√±ado con una arquitectura multihilo.
 * Operaciones Simult√°neas: El escaneo de archivos y el proceso de exfiltraci√≥n/reintento se ejecutan en paralelo, maximizando la eficiencia y la velocidad sin bloquear el agente.
 * Comunicaci√≥n Segura: Utiliza colas (queues) seguras para hilos para una comunicaci√≥n confiable entre los diferentes hilos.
üßä Dropper de Carga √ötil
 * Despliegue Post-Exfiltraci√≥n: Permite que el agente descargue y coloque un ejecutable secundario (RAT, shell, otro malware simulado) en la m√°quina objetivo despu√©s de una exfiltraci√≥n exitosa o seg√∫n un criterio.
 * Flexibilidad: Facilita la extensi√≥n de las operaciones en el objetivo.
 * Renderizado Ejecutable: Opci√≥n para establecer permisos de ejecuci√≥n en el archivo colocado.
üìä Registrador/Telemetr√≠a
 * Auditor√≠a Sigilosa: Todas las actividades del agente se registran localmente en un archivo dedicado.
 * Cifrado de Registros: El archivo de registro en s√≠ est√° cifrado con AES256 para mantener la discreci√≥n.
 * An√°lisis Post-Operacional: El panel de control web permite leer, descifrar y mostrar estos registros, ofreciendo una visibilidad completa del progreso de la operaci√≥n.
üõ†Ô∏è Instalaci√≥n y Uso (Gu√≠a Completa)
Esta gu√≠a est√° optimizada para entornos Termux (Android).
Prerrequisitos
 * Un dispositivo Android con Termux instalado.
 * Una conexi√≥n a internet activa.
 * (Opcional pero muy recomendable) Una cuenta en webhook.site para probar f√°cilmente la exfiltraci√≥n HTTP/HTTPS, o un servidor C2 que usted controle.
Pasos de Instalaci√≥n Automatizados
 * Abra Termux en su dispositivo Android.
 * Clone el repositorio de GitHub:
   git clone https://github.com/Karim93160/exfiltration_agent

 * Ejecute el script de instalaci√≥n todo en uno:
   cd exfiltration_agent
chmod +x setuptermux.sh exfagent.py control_panel.py # Asegura los permisos de ejecuci√≥n
./setup_termux.sh

   * El script instalar√° todos los paquetes Termux necesarios (Python, clang, build-essential, iproute2, procps, coreutils, etc.) y todas las dependencias de Python requeridas (pycryptodome, requests, dnspython).
   * Lanzar√° autom√°ticamente el panel de control web en segundo plano (nohup python -u control_panel.py ... &). Ver√° un mensaje nohup: ignoring input y el PID del proceso.
Acceso y Configuraci√≥n Inicial a trav√©s del Panel de Control Web
El panel de control es su interfaz gr√°fica completa para administrar el agente.
 * Acceda al Panel de Control:
   Abra el navegador web de su dispositivo Android e ingrese la direcci√≥n:
   http://127.0.0.1:8050

   (Si el puerto 8050 ya est√° en uso, aparecer√° un mensaje de error en la terminal de Termux. Deber√° modificar la l√≠nea port=8050 en el archivo control_panel.py a otro puerto, como 8051, y luego reiniciar el script).
 * Primera Configuraci√≥n:
   * Al abrirlo por primera vez (despu√©s de la generaci√≥n por setup_termux.sh), la interfaz mostrar√° una clave AES generada autom√°ticamente en el campo "Clave AES".
   * Acci√≥n Crucial: En el campo "Objetivo de Exfiltraci√≥n (URL o IP:Puerto)", reemplace la URL predeterminada con la URL √∫nica de su webhook.site o la direcci√≥n de su propio servidor de control C2. Aqu√≠ es donde el agente enviar√° los datos.
   * Todos los dem√°s campos (ruta de escaneo, tipos de archivo, etc.) se precargar√°n con valores predeterminados inteligentes (/data/data/com.termux/files/home/storage/shared es un buen punto de partida para el almacenamiento interno de Android).
 * Guarde su Configuraci√≥n:
   Una vez que haya personalizado las opciones, haga clic en el bot√≥n "Guardar Configuraci√≥n". Esto guardar√° todas las configuraciones que haya definido en el archivo ~/exfiltrationagent/sharedconfig.json. De esta manera, la pr√≥xima vez que abra el panel, sus preferencias se cargar√°n autom√°ticamente.
Uso Diario del Agente a trav√©s de la Interfaz Web
Despu√©s de la configuraci√≥n inicial, el uso es muy sencillo:
 * Inicie el Panel de Control (si no est√° ya en ejecuci√≥n):
   Si ha cerrado Termux o detenido el panel, rein√≠cielo desde el directorio del agente:
   cd ~/exfiltration_agent
nohup python -u controlpanel.py > controlpanel.log 2>&1 &

   Luego acceda de nuevo a http://127.0.0.1:8050 en su navegador.
 * Configure y Lance el Agente:
   * Los campos se precargar√°n con su √∫ltima configuraci√≥n guardada.
   * Ajuste los par√°metros seg√∫n el escenario de prueba deseado (nueva ubicaci√≥n de escaneo, nuevas palabras clave, cambio de m√©todo de exfiltraci√≥n, etc.).
   * Haga clic en el bot√≥n "Lanzar Agente". El agente se ejecutar√° en segundo plano, discretamente, y comenzar√° sus operaciones.
 * Supervise la Actividad y Gestione el Agente:
   * Haga clic en "Actualizar Registros (cifrados localmente)" para ver la actividad del agente en tiempo real en la interfaz (descifrada por el panel de control usando la clave AES del campo).
   * Si utiliza la exfiltraci√≥n HTTPS, consulte su p√°gina de webhook.site (o su C2) para verificar la recepci√≥n de los datos exfiltrados.
   * Utilice el bot√≥n "Detener Agente" para detenerlo de forma segura. Esto activar√° su mecanismo de limpieza (si no est√° desactivado en modo de depuraci√≥n).
 * Descargue los Registros para An√°lisis:
   * El bot√≥n "Descargar Registros Crudos (cifrados)" le permite recuperar el archivo agent_logs.enc. Este archivo contiene todas las actividades del agente, cifradas. Puede descifrarlo con la clave AES de su panel de control para un an√°lisis profundo sin conexi√≥n.
üìú Estructura del Proyecto (Repositorio de GitHub)
exfiltration_agent/
‚îú‚îÄ‚îÄ README.md                 # Este archivo: Documentaci√≥n completa del proyecto
‚îú‚îÄ‚îÄ exf_agent.py              # El script principal del agente de exfiltraci√≥n
‚îú‚îÄ‚îÄ control_panel.py          # El script de la interfaz web Dash para el control
‚îú‚îÄ‚îÄ modules/                  # Directorio que contiene todos los m√≥dulos internos del agente
‚îÇ   ‚îú‚îÄ‚îÄ aes256.py             # Cifrado AES-256 GCM
‚îÇ   ‚îú‚îÄ‚îÄ anti_evasion.py       # T√©cnicas anti-depuraci√≥n / sandbox
‚îÇ   ‚îú‚îÄ‚îÄ compression.py        # Compresi√≥n Zlib/Gzip
‚îÇ   ‚îú‚îÄ‚îÄ config.py             # Gesti√≥n de argumentos de configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_dns.py   # Exfiltraci√≥n a trav√©s de tunelizaci√≥n DNS
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_http.py  # Exfiltraci√≥n a trav√©s de HTTP/HTTPS
‚îÇ   ‚îú‚îÄ‚îÄ file_scanner.py       # Escaneo y filtrado de archivos
‚îÇ   ‚îú‚îÄ‚îÄ logger.py             # Registro cifrado de actividades
‚îÇ   ‚îú‚îÄ‚îÄ payload_dropper.py    # Lanzamiento de cargas √∫tiles secundarias
‚îÇ   ‚îú‚îÄ‚îÄ retry_manager.py      # Gesti√≥n de reintentos y persistencia
‚îÇ   ‚îú‚îÄ‚îÄ stealth_mode.py       # T√©cnicas de sigilo y limpieza
‚îÇ   ‚îî‚îÄ‚îÄ system_profiler.py    # Perfilado del sistema (sin psutil)
‚îú‚îÄ‚îÄ requirements.txt          # Dependencias externas de Python
‚îú‚îÄ‚îÄ setup_termux.sh           # Script de instalaci√≥n automatizada para Termux

ü§ù Contribuciones
¬°Las contribuciones son bienvenidas! Si desea mejorar ip-nose, corregir errores o agregar nuevas funcionalidades, consulte nuestra Gu√≠a de Contribuci√≥n.





Licencia üìú
hashish se distribuye bajo la licencia MIT License
Contacto üìß
Para cualquier pregunta o sugerencia, no dude en abrir una issue en GitHub o contactarnos por correo electr√≥nico:
<div align="center">
<h2>üåø exfiltration_agent - C√≥digo de Conducta üåø</h2>
<p>
Nos comprometemos a crear un entorno acogedor y respetuoso para todos los colaboradores.
Por favor, t√≥mese un momento para leer nuestro <a href="CODE_OF_CONDUCT.md">C√≥digo de Conducta</a>.
Al participar en este proyecto, usted acepta cumplir con sus t√©rminos.
</p>
<p>
<a href="CODE_OF_CONDUCT.md">
<img src="https://img.shields.io/badge/Code%20of%20Conduct-Por%20Favor%20Lea-blueviolet?style=for-the-badge&logo=github" alt="C√≥digo de Conducta">
</a>
</p>
</div>
<div align="center">
<h2>üêû Informar de un Bug en exfiltration_agent üêû</h2>
<p>
¬øEncuentra un problema con exfiltration_agent? ¬°Ay√∫denos a mejorar el proyecto informando de los errores!
Haga clic en el bot√≥n de abajo para abrir directamente un nuevo informe de error precargado.
</p>
<p>
<a href="https://github.com/karim93160/exfiltration_agent/issues/new?assignees=&labels=bug&projects=&template=bug_report.md&title=">
<img src="https://img.shields.io/badge/Informar%20un%20Bug-Abrir%20una%20Issue-red?style=for-the-badge&logo=bugsnag" alt="Informar un Bug">
</a>
</p>
</div>
<div align="center">
<h2>üí¨ Comunidad ip-nose - ¬°√önete a la Discusi√≥n! üí¨</h2>
<p>
¬øPreguntas, sugerencias o ganas de discutir el proyecto ip-nose?
¬°√önete a la comunidad en GitHub Discussions!
</p>
<p>
<a href="https://github.com/karim93160/exfiltration_agent/discussions">
<img src="https://img.shields.io/badge/Unirse%20a%20la%20Comunidad-Discusiones-blue?style=for-the-badge&logo=github" alt="Unirse a la Comunidad">
</a>
</p>
</div>
