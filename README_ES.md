![GitHub Gif](https://github.com/Karim93160/Dark-Web/blob/917902a43bee10adf623f50e420d0444155de532/20250620_032834.gif)
[üá´üá∑ Fran√ßais](https://github.com/karim93160/exfiltration_agent/blob/main/README.md) | [üá¨üáß English](https://github.com/karim93160/exfiltration_agent/blob/main/README_EN.md) | [üá™üá∏ Espa√±ol](https://github.com/karim93160/exfiltration_agent/blob/main/README_ES.md)
# Exfiltration-Agent:
*La Herramienta Furtiva de Exfiltraci√≥n de Datos para Equipos Red*

## üö® Advertencia - Uso √âtico √önicamente üö®

**Esta herramienta se desarrolla y proporciona estrictamente con fines educativos, investigaci√≥n en seguridad ofensiva y pruebas de penetraci√≥n autorizadas (Red Team).**

Cualquier uso de Exfiltration-Agent en sistemas no autorizados es estrictamente ilegal y contrario a la √©tica de la ciberseguridad. Los creadores y colaboradores de este proyecto declinan toda responsabilidad por cualquier uso abusivo o malintencionado.

**√öselo de manera responsable y solo dentro de marcos legales y √©ticos.**

## ‚ú® Visi√≥n General del Proyecto

Exfiltration-Agent es una soluci√≥n de ingenier√≠a de seguridad ofensiva dise√±ada para simular con precisi√≥n t√°cticas avanzadas de exfiltraci√≥n de datos. Construido para el sigilo, la robustez y la modularidad, este agente permite a los miembros del Red Team y analistas de seguridad probar proactivamente la resiliencia de sus infraestructuras.

Ya sea que su objetivo sea evaluar la detecci√≥n de fugas de datos, la efectividad de los firewalls o la capacidad de sus sistemas para resistir agentes discretos, Exfiltration-Agent ofrece control granular sobre sus operaciones a trav√©s de una interfaz web intuitiva.

## ¬øPor qu√© Exfiltration-Agent?

- **Simulaci√≥n Realista**: Reproduzca escenarios complejos de exfiltraci√≥n para evaluar la capacidad de su organizaci√≥n para detectar y prevenir fugas de datos.
- **Sigilo Integrado**: T√©cnicas avanzadas de ocultaci√≥n de procesos, limpieza de rastros y anti-evasi√≥n para pruebas discretas y dif√≠ciles de atribuir.
- **Multi-Canal**: Utilice varios m√©todos de exfiltraci√≥n, incluidos HTTP/HTTPS y tunneling DNS, para probar defensas multicapa y puntos ciegos.
- **Robustez Operacional**: Nunca pierda datos. El agente maneja fallas de transmisi√≥n con mecanismos de reintento inteligentes y persistencia local cifrada.
- **Facilidad de Uso**: Una interfaz web moderna e intuitiva simplifica la configuraci√≥n y el control, haciendo que la herramienta sea accesible incluso en entornos limitados como Termux.
- **Modularidad**: Su arquitectura basada en m√≥dulos separados facilita la auditor√≠a del c√≥digo, su modificaci√≥n y la adici√≥n de nuevas funciones.

## üöÄ Caracter√≠sticas Clave en Detalle

Exfiltration-Agent es un conjunto completo de capacidades de exfiltraci√≥n, cada una dise√±ada para maximizar la eficiencia y la discreci√≥n.

### üîê Cifrado AES256

- **Confidencialidad Garantizada**: Todos los datos recopilados se cifran con el algoritmo AES-256 en modo GCM (Galois/Counter Mode) antes de la transmisi√≥n.
- **Integridad y Autenticaci√≥n**: El modo GCM garantiza no solo la confidencialidad sino tambi√©n la integridad y autenticidad de los datos, protegiendo contra cualquier alteraci√≥n.
- **Clave Dedicada**: Se utiliza una clave AES √∫nica, configurable a trav√©s de la interfaz, garantizando la seguridad de sus exfiltraciones.

### üóúÔ∏è Compresi√≥n Zlib/Gzip

- **Optimizaci√≥n de Ancho de Banda**: Los datos se comprimen con Zlib o Gzip antes del cifrado y el env√≠o, reduciendo as√≠ el tama√±o de la carga √∫til y el consumo de red.
- **Velocidad de Exfiltraci√≥n**: Transferencias m√°s peque√±as resultan en exfiltraciones m√°s r√°pidas y menos tiempo en la red, aumentando el sigilo.

### üìÅ Escaneo y Filtrado Avanzado de Archivos

- **B√∫squeda Recursiva**: Escanea en profundidad los directorios especificados para descubrir archivos objetivo.
- **Filtrado Granular**:
  - **Por Extensi√≥n**: Inclusi√≥n (.doc, .txt, .db) y exclusi√≥n (.exe, .dll) de tipos de archivos espec√≠ficos.
  - **Por Tama√±o**: Definici√≥n de tama√±os m√≠nimos y m√°ximos para apuntar a archivos relevantes.
  - **Por Contenido**: B√∫squeda de palabras clave espec√≠ficas o patrones de expresiones regulares (regex) dentro de los archivos para identificar datos sensibles.

### üíª Perfilado del Sistema (sin psutil)

- **Reconocimiento Profundo**: Recopila informaci√≥n vital sobre el entorno comprometido sin dependencias externas complejas.
- **Informaci√≥n Recopilada**:
  - Nombre de host y detalles del sistema operativo.
  - Informaci√≥n de CPU y memoria.
  - Informaci√≥n de particiones de disco.
  - Detalles de interfaces de red (direcciones IP, servidores DNS).
  - Usuarios conectados y procesos en ejecuci√≥n.
- **Robustez**: Utiliza comandos nativos de shell (df, ip, ps, who, cat /proc/...) para garantizar la m√°xima compatibilidad en sistemas heterog√©neos (incluido Termux).

### üß¨ Anti-Debug / Sandbox & Evasi√≥n

- **Detecci√≥n de Entornos Hostiles**: El agente intenta identificar si se est√° ejecutando en un entorno de an√°lisis, como un depurador, m√°quina virtual o contenedor.
- **Estrategias de Evasi√≥n**:
  - Verificaci√≥n de procesos padres sospechosos.
  - An√°lisis del tiempo de actividad del sistema (tiempo de ejecuci√≥n corto = sandbox).
  - Verificaci√≥n de proporciones de espacio en disco.
  - B√∫squeda de artefactos espec√≠ficos de VM/contenedores.
  - Verificaci√≥n de ptrace (detecci√≥n de depurador en Linux).
  - An√°lisis de indicadores de virtualizaci√≥n en las banderas de la CPU.
- **Comportamiento Adaptativo**: Si se detecta un entorno sospechoso, el agente puede apagarse silenciosamente o alterar su comportamiento para evitar el an√°lisis.

### üåê Exfiltraci√≥n HTTP/HTTPS

- **Canal Principal**: La forma m√°s com√∫n y a menudo m√°s efectiva de transferir datos.
- **Sigilo de Red**: Utiliza la biblioteca requests con User-Agents aleatorios y encabezados HTTP realistas para enmascarar el tr√°fico de exfiltraci√≥n entre el tr√°fico web normal.
- **Manejo Robusto**: Incluye manejo de timeouts, errores de conexi√≥n y respuestas HTTP.

### üì° Exfiltraci√≥n DNS

- **Canal Furtivo Avanzado**: Un m√©todo de exfiltraci√≥n a menudo subestimado, ya que el tr√°fico DNS rara vez se inspecciona en profundidad.
- **Tunelamiento Inteligente**: Los datos binarios (cifrados y comprimidos) se codifican en Base32 o Hexadecimal, luego se dividen en peque√±os "chunks" enviados como subdominios en consultas DNS (Tipo A).
- **Fiabilidad**: Incluye IDs de transacci√≥n e √≠ndices de chunk para permitir que el servidor de control reensamble los datos correctamente.

### üîÑ Gestor de Reintentos/Rotaci√≥n

- **Persistencia de Datos**: Si un intento de exfiltraci√≥n falla (problema de red, servidor inaccesible), los datos no se pierden.
- **Reintentos Inteligentes**: Los datos se ponen en cola y se realizan intentos de reenv√≠o con retroceso exponencial (aumento del retraso entre intentos) para evitar saturar la red o el C2.
- **Registro Local Cifrado**: Los datos que persisten en la cola se guardan en un archivo local cifrado, garantizando su seguridad incluso en la m√°quina comprometida.

### üïµÔ∏è Modo Sigilo

- **Ocultaci√≥n de Procesos**: Intenta modificar el nombre del proceso visible para mezclarse con procesos leg√≠timos del sistema.
- **Directorio de Trabajo Temporal**: Utiliza rutas ef√≠meras (/tmp o equivalente de Termux) para almacenar archivos temporales, evitando rastros persistentes.
- **Auto-Eliminaci√≥n de Registros y Archivos**: Al final de la operaci√≥n (a menos que se desactive en modo debug), el agente limpia activamente todos los registros cifrados y archivos temporales que cre√≥.
- **Timestomping**: Altera las marcas de tiempo de archivos creados o modificados para ocultar la actividad reciente del agente.

### üîÅ Hilos/Tareas As√≠ncronas

- **Rendimiento √ìptimo**: El agente est√° dise√±ado con una arquitectura multi-hilo.
- **Operaciones Simult√°neas**: El escaneo de archivos y el proceso de exfiltraci√≥n/reintento se ejecutan en paralelo, maximizando la eficiencia y la velocidad sin bloquear el agente.
- **Comunicaci√≥n Segura**: Utiliza colas seguras para hilos para una comunicaci√≥n confiable entre los diferentes hilos.

### üßä Payload Dropper

- **Despliegue Post-Exfiltraci√≥n**: Permite al agente descargar y colocar un ejecutable secundario (RAT, shell, otro malware simulado) en la m√°quina objetivo despu√©s de una exfiltraci√≥n exitosa o seg√∫n un criterio.
- **Flexibilidad**: Facilita la extensi√≥n de las operaciones en el objetivo.
- **Habilitaci√≥n de Ejecuci√≥n**: Opci√≥n para establecer permisos de ejecuci√≥n en el archivo colocado.

### üìä Registrador/Telemetr√≠a

- **Auditor√≠a Furtiva**: Todas las actividades del agente se registran localmente en un archivo dedicado.
- **Cifrado de Registros**: El archivo de registro en s√≠ est√° cifrado con AES256 para mantener la discreci√≥n.
- **An√°lisis Post-Operacional**: El panel de control web permite leer, descifrar y mostrar estos registros, ofreciendo visibilidad completa sobre el progreso de la operaci√≥n.

## üõ†Ô∏è Instalaci√≥n y Uso (Gu√≠a Completa)

Esta gu√≠a est√° optimizada para entornos Termux (Android).

### Requisitos Previos

- Un dispositivo Android con Termux instalado.
- Una conexi√≥n a Internet activa.
- (Opcional pero altamente recomendado) Una cuenta en webhook.site para probar f√°cilmente la exfiltraci√≥n HTTP/HTTPS, o un servidor C2 que controle.

### Pasos de Instalaci√≥n Automatizados

1. Abra Termux en su dispositivo Android.
2. Clone el repositorio de GitHub:
   ```bash
   git clone https://github.com/Karim93160/exfiltration_agent
   ```
3. Ejecute el script de instalaci√≥n todo-en-uno:
   ```bash
   cd exfiltration_agent
chmod +x setup_termux.sh exf_agent.py control_panel.py
./setup_termux.sh

   ```
   - El script instalar√° todos los paquetes necesarios de Termux (Python, clang, build-essential, iproute2, procps, coreutils, etc.) y todas las dependencias de Python requeridas (pycryptodome, requests, dnspython).
   - Lanzar√° autom√°ticamente el panel de control web en segundo plano (`nohup python -u control_panel.py ... &`). Ver√° un mensaje `nohup: ignoring input` y el PID del proceso.

### Acceso Inicial y Configuraci√≥n a trav√©s del Panel de Control Web

El panel de control es su interfaz gr√°fica completa para gestionar el agente.

1. **Acceda al Panel de Control**:
   Abra el navegador web de su dispositivo Android e ingrese la direcci√≥n:
   ```
   http://127.0.0.1:8050
   ```
   *(Si el puerto 8050 ya est√° en uso, aparecer√° un mensaje de error en la terminal de Termux. Deber√° modificar la l√≠nea `port=8050` en el archivo `control_panel.py` a otro puerto, como 8051, y luego reiniciar el script.)*

2. **Primera Configuraci√≥n**:
   - En la primera apertura (despu√©s de la generaci√≥n por `setup_termux.sh`), la interfaz mostrar√° una clave AES generada autom√°ticamente en el campo "Clave AES".
   - **Acci√≥n Crucial**: En el campo "Objetivo de Exfiltraci√≥n (URL o IP:Puerto)", reemplace la URL predeterminada con su URL √∫nica de webhook.site o la direcci√≥n de su propio servidor de control C2. Aqu√≠ es donde el agente enviar√° los datos.
   - Todos los dem√°s campos (ruta de escaneo, tipos de archivos, etc.) estar√°n pre-llenados con valores predeterminados inteligentes (`/data/data/com.termux/files/home/storage/shared` es un buen punto de partida para el almacenamiento interno de Android).

3. **Guarde su Configuraci√≥n**:
   Una vez que haya personalizado las opciones, haga clic en el bot√≥n "Guardar Configuraci√≥n". Esto guardar√° todas las configuraciones que haya definido en el archivo `~/exfiltrationagent/sharedconfig.json`. De esta manera, la pr√≥xima vez que abra el panel, sus preferencias se cargar√°n autom√°ticamente.

### Uso Diario del Agente a trav√©s de la Interfaz Web

Despu√©s de la configuraci√≥n inicial, el uso es muy simple:

1. **Inicie el Panel de Control (si no est√° ya en ejecuci√≥n)**:
   Si ha cerrado Termux o detenido el panel, rein√≠cielo desde el directorio del agente:
   ```bash
   cd ~/exfiltration_agent
   nohup python -u controlpanel.py > controlpanel.log 2>&1 &
   ```
   Luego acceda nuevamente a `http://127.0.0.1:8050` en su navegador.

2. **Configure y Lance el Agente**:
   - Los campos estar√°n pre-llenados con su √∫ltima configuraci√≥n guardada.
   - Ajuste la configuraci√≥n seg√∫n el escenario de prueba deseado (nueva ubicaci√≥n de escaneo, nuevas palabras clave, cambio de m√©todo de exfiltraci√≥n, etc.).
   - Haga clic en el bot√≥n "Iniciar Agente". El agente se ejecutar√° en segundo plano, discretamente, y comenzar√° sus operaciones.

3. **Monitoree la Actividad y Gestione el Agente**:
   - Haga clic en "Actualizar Registros (localmente cifrados)" para ver la actividad del agente en tiempo real en la interfaz (descifrada por el panel de control usando la clave AES del campo).
   - Si utiliza la exfiltraci√≥n HTTPS, consulte su p√°gina de webhook.site (o su C2) para verificar la recepci√≥n de los datos exfiltrados.
   - Utilice el bot√≥n "Detener Agente" para detenerlo limpiamente. Esto activar√° su mecanismo de limpieza (a menos que se desactive en modo debug).

4. **Descargue Registros para An√°lisis**:
   - El bot√≥n "Descargar Registros Crudos (cifrados)" le permite recuperar el archivo `agent_logs.enc`. Este archivo contiene todas las actividades del agente, cifradas. Puede descifrarlo con la clave AES de su panel de control para un an√°lisis en profundidad sin conexi√≥n.

## üìú Estructura del Proyecto (Repositorio GitHub)

```
exfiltration_agent/
‚îú‚îÄ‚îÄ README.md                 # Este archivo: Documentaci√≥n completa del proyecto
‚îú‚îÄ‚îÄ exf_agent.py              # El script principal del agente de exfiltraci√≥n
‚îú‚îÄ‚îÄ control_panel.py          # El script de la interfaz web Dash para el control
‚îú‚îÄ‚îÄ modules/                  # Directorio que contiene todos los m√≥dulos internos del agente
‚îÇ   ‚îú‚îÄ‚îÄ aes256.py             # Cifrado AES-256 GCM
‚îÇ   ‚îú‚îÄ‚îÄ anti_evasion.py       # T√©cnicas anti-debugging / sandbox
‚îÇ   ‚îú‚îÄ‚îÄ compression.py        # Compresi√≥n Zlib/Gzip
‚îÇ   ‚îú‚îÄ‚îÄ config.py             # Gesti√≥n de argumentos de configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_dns.py   # Exfiltraci√≥n mediante tunneling DNS
‚îÇ   ‚îú‚îÄ‚îÄ exfiltration_http.py  # Exfiltraci√≥n mediante HTTP/HTTPS
‚îÇ   ‚îú‚îÄ‚îÄ file_scanner.py       # Escaneo y filtrado de archivos
‚îÇ   ‚îú‚îÄ‚îÄ logger.py             # Registro cifrado de actividades
‚îÇ   ‚îú‚îÄ‚îÄ payload_dropper.py    # Colocaci√≥n de payloads secundarios
‚îÇ   ‚îú‚îÄ‚îÄ retry_manager.py      # Gesti√≥n de reintentos y persistencia
‚îÇ   ‚îú‚îÄ‚îÄ stealth_mode.py       # T√©cnicas de sigilo y limpieza
‚îÇ   ‚îî‚îÄ‚îÄ system_profiler.py    # Perfilado del sistema (sin psutil)
‚îú‚îÄ‚îÄ requirements.txt          # Dependencias externas de Python
‚îú‚îÄ‚îÄ setup_termux.sh           # Script de instalaci√≥n automatizado para Termux
‚îî‚îÄ‚îÄ backup_agent.sh           # Script para crear copias de seguridad del proyecto
```

## ü§ù Contribuciones y Soporte

¬°Las contribuciones son bienvenidas! Si tiene ideas de mejora, informes de errores o sugerencias, por favor:

- **Abra un Issue**: Para reportar un error o sugerir una nueva caracter√≠stica.
- **Env√≠e un Pull Request**: Para proponer cambios o adiciones de c√≥digo.

¬°Su ayuda es valiosa para hacer evolucionar Exfiltration-Agent!

## üõ°Ô∏è Licencia

Este proyecto se distribuye bajo la Licencia MIT. Esto significa que es libre de usar, copiar, modificar, fusionar, publicar, distribuir, sublicenciar y/o vender copias del Software, sujeto a los t√©rminos establecidos en la licencia.

**Licencia MIT**

<div align="center">
<h2>üåø Exfiltration-Agent - C√≥digo de Conducta üåø</h2>
<p>
Estamos comprometidos a crear un ambiente acogedor y respetuoso para todos los contribuyentes.
Por favor, t√≥mese un momento para leer nuestro <a href="CODIGO_DE_CONDUCTA.md">C√≥digo de Conducta</a>.
Al participar en este proyecto, usted acepta cumplir con sus t√©rminos.
</p>
<p>
<a href="CODIGO_DE_CONDUCTA.md">
<img src="https://img.shields.io/badge/C%C3%B3digo%20de%20Conducta-Lea%20Por%20Favor-blueviolet?style=for-the-badge&logo=github" alt="C√≥digo de Conducta">
</a>
</p>
</div>

<div align="center">
<h2>üêû Reportar un Error en Exfiltration-Agent üêû</h2>
<p>
¬øEncontr√≥ un problema con Exfiltration-Agent? ¬°Ay√∫denos a mejorar el proyecto reportando errores!
Haga clic en el bot√≥n de abajo para abrir directamente un nuevo informe de error pre-llenado.
</p>
<p>
<a href="https://github.com/karim93160/exfiltration_agent/issues/new?assignees=&labels=bug&projects=&template=bug_report.md&title=">
<img src="https://img.shields.io/badge/Reportar%20Error-Abrir%20un%20Issue-red?style=for-the-badge&logo=bugsnag" alt="Reportar un Error">
</a>
</p>
</div>

<div align="center">
<h2>üí¨ Comunidad de Exfiltration-Agent - ¬°√önase a la Discusi√≥n! üí¨</h2>
<p>
¬øPreguntas, sugerencias o quiere discutir el proyecto Exfiltration-Agent?
¬°√önase a la comunidad en GitHub Discussions!
</p>
<p>
<a href="https://github.com/karim93160/exfiltration_agent/discussions">
<img src="https://img.shields.io/badge/Unirse%20a%20la%20Comunidad-Discusiones-blue?style=for-the-badge&logo=github" alt="Unirse a la Comunidad">
</a>
</p>
</div>
```
